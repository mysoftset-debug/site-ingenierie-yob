<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Nos Formations - INGENIERIE CHEZ YOB</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav>
        <ul>
            <li><a href="index.html">Accueil</a></li>
            <li><a href="services.html">Nos Services</a></li>
            <li><a href="formations.html">Nos Formations</a></li>
            <li><a href="articles.html">Nos articles</a></li>
            <li><a href="contact.html">Nos Contacts</a></li>
            <li><a href="apropos.html">A propos</a></li>
        </ul>
    </nav>

    <div id="formations" class="section">
        <h2>Nos Formations</h2>
        <div class="formation-list">

            <div class="formation-item">
                <img src="images/formation-info.jpg" alt="Initiation à l'informatique">
                <div class="formation-text">
                    <h3>Initiation à l'informatique</h3>
                    <p>Maîtrisez les bases de l'ordinateur, la navigation sur internet, la messagerie et les outils bureautiques essentiels (Word, Excel). Idéal pour les débutants de tous âges.</p>
                    <p class="formation-meta"><strong>Durée :</strong> <span class="details">1 mois</span> | <strong>Prix :</strong> <span class="details">50.000 FCFA</span></p>
                    <p><button class="btn-register" data-course-id="init-info" data-course-name="Initiation à l'informatique" data-course-price="50000">S'inscrire / Payer</button></p>
                </div>
            </div>

            <div class="formation-item">
                <img src="images/formation-secretariat.jpg" alt="Formation en Secrétariat">
                <div class="formation-text">
                    <h3>Secrétariat</h3>
                    <p>Devenez un(e) assistant(e) efficace. Apprenez la dactylographie, la gestion d'agenda, la rédaction de courriers professionnels et l'utilisation avancée des logiciels de bureau.</p>
                    <p class="formation-meta"><strong>Durée :</strong> <span class="details">3 mois</span> | <strong>Prix :</strong> <span class="details">120.000 FCFA</span></p>
                    <p><button class="btn-register" data-course-id="secretariat" data-course-name="Secrétariat" data-course-price="120000">S'inscrire / Payer</button></p>
                </div>
            </div>

            <div class="formation-item">
                <img src="images/formation-graphisme.jpg" alt="Formation en Graphisme">
                <div class="formation-text">
                    <h3>Graphisme</h3>
                    <p>Libérez votre créativité. Apprenez à utiliser les logiciels de la suite Adobe (Photoshop, Illustrator) pour créer des logos, affiches, et visuels percutants pour le web et l'impression.</p>
                    <p class="formation-meta"><strong>Durée :</strong> <span class="details">4 mois</span> | <strong>Prix :</strong> <span class="details">200.000 FCFA</span></p>
                        <p><button class="btn-register" data-course-id="graphisme" data-course-name="Graphisme" data-course-price="200000">S'inscrire / Payer</button></p>
                </div>
            </div>

            <div class="formation-item">
                <img src="images/formation-algo.jpg" alt="Formation en Algorithme et Programmation">
                <div class="formation-text">
                    <h3>Algorithme et Programmation</h3>
                    <p>Découvrez la logique derrière le code. Cette formation fondamentale vous apprend à résoudre des problèmes et à écrire vos premiers programmes, une étape essentielle pour tout futur développeur.</p>
                    <p class="formation-meta"><strong>Durée :</strong> <span class="details">2 mois</span> | <strong>Prix :</strong> <span class="details">100.000 FCFA</span></p>
                        <p><button class="btn-register" data-course-id="algo" data-course-name="Algorithme et Programmation" data-course-price="100000">S'inscrire / Payer</button></p>
                </div>
            </div>

            <div class="formation-item">
                <img src="images/formation-web.jpg" alt="Formation en Développement Web">
                <div class="formation-text">
                    <h3>Développement Web</h3>
                    <p>Apprenez à créer des sites web dynamiques et interactifs de A à Z. Maîtrisez les langages clés du web : HTML, CSS, JavaScript, et découvrez les frameworks modernes.</p>
                    <p class="formation-meta"><strong>Durée :</strong> <span class="details">6 mois</span> | <strong>Prix :</strong> <span class="details">350.000 FCFA</span></p>
                        <p><button class="btn-register" data-course-id="web" data-course-name="Développement Web" data-course-price="350000">S'inscrire / Payer</button></p>
                </div>
            </div>

            <div class="formation-item">
                <img src="images/formation-maintenance.jpg" alt="Formation en Maintenance informatique">
                <div class="formation-text">
                    <h3>Maintenance informatique et réseau</h3>
                    <p>Devenez technicien de maintenance. Apprenez à diagnostiquer, réparer et assembler des ordinateurs, ainsi qu'à configurer et dépanner des réseaux locaux.</p>
                    <p class="formation-meta"><strong>Durée :</strong> <span class="details">5 mois</span> | <strong>Prix :</strong> <span class="details">250.000 FCFA</span></p>
                        <p><button class="btn-register" data-course-id="maintenance" data-course-name="Maintenance informatique et réseau" data-course-price="250000">S'inscrire / Payer</button></p>
                </div>
            </div>

            <div class="formation-item">
                <img src="images/formation-genie-logiciel.jpg" alt="Formation en Génie Logiciel">
                <div class="formation-text">
                    <h3>Génie Logiciel</h3>
                    <p>Notre formation phare. Plongez dans la conception, le développement et la maintenance de logiciels robustes. Un parcours complet pour devenir un ingénieur logiciel compétent.</p>
                    <p class="formation-meta"><strong>Durée :</strong> <span class="details">12 mois</span> | <strong>Prix :</strong> <span class="details">700.000 FCFA</span></p>
                        <p><button class="btn-register" data-course-id="genie" data-course-name="Génie Logiciel" data-course-price="700000">S'inscrire / Payer</button></p>
                </div>
            </div>

        </div>
    </div>

    <div class="ticker-wrap">
        <div class="ticker-move">
            <span>Nos formations en génie logiciel démarrent le 1er Novembre 2025</span>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const stickyTitle = document.querySelector('.section h2');
            if (stickyTitle) {
                const navHeight = document.querySelector('nav').offsetHeight;
                window.addEventListener('scroll', function() {
                    const stickyPoint = stickyTitle.parentElement.offsetTop - navHeight;
                    if (window.scrollY > stickyPoint) {
                        stickyTitle.classList.add('is-sticky');
                    } else {
                        stickyTitle.classList.remove('is-sticky');
                    }
                });
            }
        });
    </script>

    <!-- Registration Modal -->
    <div id="registerModal" class="modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); align-items:center; justify-content:center;">
        <div style="background:#fff; padding:20px; max-width:420px; width:100%; border-radius:6px;">
            <h3 id="modalCourseTitle">S'inscrire</h3>
            <form id="registerForm">
                <input type="hidden" name="courseId" id="courseId">
                <input type="hidden" name="courseName" id="courseName">
                <div style="margin-bottom:8px;"><label>Prénom et Nom<br><input type="text" id="fullName" name="fullName" required style="width:100%;"></label></div>
                <div style="margin-bottom:8px;"><label>Email<br><input type="email" id="email" name="email" required style="width:100%;"></label></div>
                <div id="form-buttons" style="display:flex; gap:8px; justify-content:flex-end;">
                    <button type="button" id="cancelBtn">Annuler</button>
                    <button type="submit" id="payBtn">Valider l'inscription</button>
                </div>
                <div id="download-section" style="display:none;">
                    <p>Votre badge est prêt ! Cliquez pour le télécharger et continuer.</p>
                    <button type="button" id="downloadBtn" style="width:100%; padding:10px; background-color: #28a745; color: white; border: none; border-radius: 4px;">Télécharger mon badge</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Client-side registration -> calls backend to create Stripe Checkout session
        (function(){
            const modal = document.getElementById('registerModal');
            const form = document.getElementById('registerForm');
            const modalCourseTitle = document.getElementById('modalCourseTitle');
            const courseIdInput = document.getElementById('courseId');
            const courseNameInput = document.getElementById('courseName');

            document.querySelectorAll('.btn-register').forEach(btn => {
                btn.addEventListener('click', () => {
                    const courseName = btn.getAttribute('data-course-name');
                    const courseId = btn.getAttribute('data-course-id');
                    modalCourseTitle.textContent = `S'inscrire: ${courseName}`;
                    courseIdInput.value = courseId;
                    courseNameInput.value = courseName;
                    modal.style.display = 'flex';
                });
            });

            document.getElementById('cancelBtn').addEventListener('click', () => modal.style.display = 'none');

            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const fullName = document.getElementById('fullName').value.trim();
                const email = document.getElementById('email').value.trim();
                const courseId = courseIdInput.value;
                const courseName = courseNameInput.value;
                if (!fullName || !email) return alert('Veuillez renseigner votre nom complet et votre email.');

                try {
                    const res = await fetch('/api/generate-badge', {
                        method: 'POST',
                        headers: {'Content-Type':'application/json'},
                        body: JSON.stringify({ fullName, email, courseId, courseName })
                    });
                    const data = await res.json();
                    if (data.success && data.badgeUrl) {
                        document.getElementById('form-buttons').style.display = 'none';
                        const downloadSection = document.getElementById('download-section');
                        const downloadBtn = document.getElementById('downloadBtn');
                        
                        downloadBtn.onclick = () => {
                            // Start download
                            const link = document.createElement('a');
                            link.href = data.badgeUrl;
                            link.download = data.fileName;
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);

                            // Redirect to WhatsApp
                            const whatsappMessage = encodeURIComponent(`Bonjour M. le Directeur de l'INGENIRIE CHEZ YOB. Je suis ${fullName}, et je viens de m'inscrire dans la filère "${courseName}". Je voudrais la suite de la procédure.`);
                            window.location.href = `https://wa.me/22962942559?text=${whatsappMessage}`;
                        };
                        
                        downloadSection.style.display = 'block';
                    } else {
                        alert('Erreur lors de la génération du badge.');
                    }
                } catch (err) {
                    console.error(err);
                    alert('Erreur réseau. Réessayez plus tard.');
                }
            });
        })();
    </script>

</body>
</html>